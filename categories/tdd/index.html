<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>TDD | Sohan's Blog</title>
<meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Sohan's Blog"><meta name=generator content="Hugo 0.121.2"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><link href=/categories/tdd/index.xml rel=alternate type=application/rss+xml title="Sohan's Blog"><link href=/categories/tdd/index.xml rel=feed type=application/rss+xml title="Sohan's Blog"><meta property="og:title" content="TDD"><meta property="og:description" content="Sohan's Blog"><meta property="og:type" content="website"><meta property="og:url" content="http://smsohan.com/categories/tdd/"><meta itemprop=name content="TDD"><meta itemprop=description content="Sohan's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="TDD"><meta name=twitter:description content="Sohan's Blog"><style>.athelas,.body-text{font-family:helvetica neue,Helvetica,Arial,sans-serif}.body-text div,p,article,section{font-size:1rem;line-height:1.4rem}.athelas.fw1{font-weight:inherit}h1.f1{line-height:4rem}</style></head><body class="ma0 body-text"><header><div class="pb3-m bg-navy"><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Sohan's Blog</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/home/ title="About page">About</a></li></ul><div class=ananke-socials></div></div></div></nav></div></header><main class=pb7 role=main><article class="cf pa3 pa4-m pa4-l"><div class="measure-wide-l center f4 lh-copy nested-copy-line-height nested-links mid-gray"><p>Below you will find pages that utilize the taxonomy term “TDD”</p></div></article><div class="mw8 center"><section class="flex-ns flex-wrap justify-around mt5"><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2013/02/27/random-data-in-tests/ class="link black dim">Random Data in Tests</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">&mldr; are evil if you expect the randomizer to give you unique values on each call.
Here&rsquo;s an example:
before(:each) do @user_1 = User.create!(email: "email-#{Random.rand(1000)}@example.com") # the following will fail intermittently if you have a unique validation on User#email @user_2 = User.create!(email: "email-#{Random.rand(1000)}@example.com") end It&rsquo;s a timebomb, use it, it will haunt you later. Be sane, stop using random numbers in tests like this.</div></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2012/12/06/the-myth-of-one-assert-per-test/ class="link black dim">The Myth of One Assert Per Test</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">TL;DR; It&rsquo;s not one assert per test, rather one logical path per test.
I find this to be a classical example of how an inappropriate choice of terminology leads to huge confusion. In trying to find the original source of the &ldquo;one assertion per test&rdquo; quote, google came back only with a bunch of confused blog entries :(
Without much ranting, lets see a code example to start with:</div></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2012/11/28/readable-unit-tests/ class="link black dim">Readable Unit Tests</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">From my experience with writing/reading unit tests for years, here&rsquo;s a little guideline to keep &rsquo;em readable:
A unit test needs to fit entirely (including setups) on a screen without scrolling. It is OK to have a little bit of duplication in unit tests for readability. Avoid nesting of contexts beyond 2 levels. Instead, use methods to setup and flatten. Do not use if/else/loops in a unit test. If your test needs too much setup/mocking/stubbing, time to refactor the code.</div></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2012/11/27/unit-testing-asynchronous-side-effects/ class="link black dim">Unit Testing and Sleep</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">If your unit test code needs a sleep, its time to refactor it. Ideally, you&rsquo;d only need to stub/mock the asynchronous call instead of introducing arbitrary sleeps in the test code, because they will eventually fail. Moreover, until it fails, it will slow down your test runner.</div></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2011/08/15/should-you-unit-test-interaction-with/ class="link black dim">Should You Unit Test Interaction with Static Methods?</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">No. You should not. Here's an example:
If you are somehow mocking this static method, you are potentially making it dangerous for other places where this static method is used. Eventually, this will create red test results that are hard to find and make your tests dependent on each other.</div></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2011/08/09/should-you-unit-test-methods-with-lot/ class="link black dim">Should you unit test methods with a lot of mocking?</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">Well, anytime you have a lot of mocking, it is probably a smell. Particularly, a first smell is violation of the law of demeter. However, we were having discussion about whether or not we should write unit test for something like the following example:
As you can see, this method actually does a quite important task. It invokes the search method with specific parameters that will determine your search results.</div></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2011/07/26/should-you-write-unit-tests-for/ class="link black dim">Constructors Are Methods, too!</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">Yes, if your constructor does something meaningful. This is just like another method and should be treated equally for unit testsing purpose. Here's an example that should need unit test:
It looks simple, so testing it should be simple, too. I would only skip the default constuctors, as long as they don't do anything interesting. Comments Alexander Beletsky Sure, the constructors are methods too.. but they should not do anything more except internal initialization.</div></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2009/06/03/its-easier-to-get-lost-would-you/ class="link black dim">Its easier to get lost! Would you?</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">I was talking to a friend of mine, who started a IT start up and working full time with a few others to foster the business. He was telling me-
“We have 13 projects running at this moment. We are working our heart out. But, we are not finding any time to do Test Driven Development, Continuous Integration and all the good things…”
Well, I understand how it feels! As the title says, “Its easier to get lost!</div></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2009/05/13/unit-test-actioncontroller-filters/ class="link black dim">Unit/Functional Test Rails ActionController filters following DRY</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">At ScrumPad most of our controllers are bounded by filters for authentication/authorization. Some filters apply to all actions in a controller while others apply to only a few or leave out only a few. However, since we are following TDD, we need to test the filter is invoked before each of the desired action. This makes the test code MOIST (not DRY)!
Example of Moist Code:
The following example only captures two test methods.</div></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2009/04/21/unit-test-eager-loading-in-rails/ class="link black dim">Unit Test eager loading in Rails ActiveRecord association</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">To avoid the n+1 problem, you need to use eager loading in ActiveRecord object associations. An easy implementation of eager loading can be done using named scope in the following way.
class User &lt; ActiveRecord::Base
has_many :friends
named_scope :eager_load_friends, :include => :fiends
end
User.find(user_id).eager_load_friendsTo unit test the named scope, you can use this following helper method (keep it in test_helper.rb, if you like) that I wrote for ScrumPad
def test_eager_loaded(model, association)</div></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2008/11/26/part-1-how-am-i-impacting/ class="link black dim">Part 1: How am I IMPACTing following Scrum?</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">In a previous post in this blog, I introduced the nice little acronym IMPACT for agile. To recap, here is what IMPACT stands for -
"Iterative and Incremental development of a software by means of Merciless refactoring, Peer reviews, Automated acceptance testing, Continuous integration and of course, Test driven development"
To give you a little background around my story, let me tell you about a project that I am working since June 2006.</div></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2008/09/01/bdd-my-first-bdd-code-using-rspec-in/ class="link black dim">BDD - My First BDD Code using RSpec in Ruby</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">I am really really happy to see people putting so much efforts for building high quality, nearly all avoidable error free software. I am a big believer of Test Driven Development and doing TDD for about two years now. I have always had the feeling that TDD is a kind of a misnomer because to some people the term 'Test' refers to finding bugs. For this very reason, when people gets started with TDD, they consider it as a waste of time to write so much extra code that doesn't necessarily find bugs!</div></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2008/08/03/ninject-dependency-injection-framework/ class="link black dim">Ninject - Dependency Injection Framework for .Net Objects</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">I loved Ninject because
- I don't love to write/edit XML documents myself.
- I think Ninject can save a lot of coding and debugging time.
- This is a cool framework :-) with a fun-to-read documentation.
- It uses simple conventions and Attributes for resolving most dependencies behind the scene.
- You can take full advantage to lambda expressions for writing compact codes.
Today, I took a look into this Ninject framework.</div></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2008/03/20/solution-to-problem-with-creating-mocks/ class="link black dim">A solution to the problem with creating mocks for interfaces with Generic Methods with NMock</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">I was so happy with NMock to see how it can dynamically generate mocks of interfaces and also gives me a fluent interface to write expectations and everything it does to help me in unit testing!
However, I could not generate dynamic mocks for interfaces with Generic methods and it kept showing me the 'TypeLoadException' on and on. My interface looks like the following -
interface IObjectFactory
{
T GetObject(string id);</div></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2008/03/16/mock-internal-interface-with-nmock2-use/ class="link black dim">Mock Internal Interface with NMock2 - Use InternalsVisibleToAttribute</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">Yesterday I badly needed to create mocks for my internal interfaces. I am using NMock2 as a Mocking framework and found it really difficult to produce Mocks for internal interfaces. After some 'google time' and investigation I found that you need the following two lines in your AssemblyInfo.cs to achieve this purpose-
[assembly: InternalsVisibleTo("Mocks")]
[assembly: InternalsVisibleTo("MockObjects")]
Where are the two assemblies? I found that these two assemblies are dynamically created by NMock2 for mocking your interfaces.</div></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2008/03/11/testing-internal-class-in-net-c/ class="link black dim">Testing Internal Class in .Net C#</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">I have been to a situation where only a small number of classes had been declared as public classes in an assembly. And most of the classes are declared as internal, because I wanted to expose only the public classes to the consumers of my assembly.
However, doing so creates another challenge in testing the internal classes. As we most commonly want our test codes to reside on a separate assembly so that we can leave that assembly out when we are releasing the end product.</div></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2007/12/02/easiest-and-hardest-methods-to-write/ class="link black dim">The Easiest and the Hardest Methods to write unit test for</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">I was wondering to find out the easiest methods to write unit tests for. I came up with a few results as the following ones...
a. A method that takes no parameter, perform calculations on only local data and always returns a constant value is the easiest to test. But the question is, is this at all important to have such methods?
b. A method that takes some parameters, and limits its operations only on the supplied parameters and local variables and returns some value or throws exception is also very easy to write a test for.</div></div></div></div><div class="relative w-100 mb4 bg-white"><div class="relative w-100 mb4 bg-white nested-copy-line-height"><div class="bg-white mb3 pa4 gray overflow-hidden"><span class="f6 db">Posts</span><h1 class="f3 near-black"><a href=/blog/2007/12/02/unit-testing-void-methods-part-1/ class="link black dim">Unit Testing void Methods - Part 1</a></h1><div class="nested-links f5 lh-copy nested-copy-line-height">Dissection of void Methods without parameters
Methods with void return types incur complexities in writing unit tests. So, we need to characterize the void methods to make sure we have guards against the odds for testability.
A typical void method without any parameter looks like the following
public void DoSomething()
{
//1.modifies some member variables
this.someMemberVariable = 10;
//2.Calls methods of the same class or other classes
someClass.SomeOtherMethod(someArg);
//3.Sometimes throws exception</div></div></div></div></section></div></main><footer class="bg-navy bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=http://smsohan.com/>&copy; Sohan's Blog 2024</a><div><div class=ananke-socials></div></div></div></footer></body></html>