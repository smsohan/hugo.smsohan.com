<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Testing Internal Class in .Net C# | Sohan's Blog</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="I have been to a situation where only a small number of classes had been declared as public classes in an assembly. And most of the classes are declared as internal, because I wanted to expose only the public classes to the consumers of my assembly.
However, doing so creates another challenge in testing the internal classes. As we most commonly want our test codes to reside on a separate assembly so that we can leave that assembly out when we are releasing the end product."><meta name=generator content="Hugo 0.108.0"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><meta property="og:title" content="Testing Internal Class in .Net C#"><meta property="og:description" content="I have been to a situation where only a small number of classes had been declared as public classes in an assembly. And most of the classes are declared as internal, because I wanted to expose only the public classes to the consumers of my assembly.
However, doing so creates another challenge in testing the internal classes. As we most commonly want our test codes to reside on a separate assembly so that we can leave that assembly out when we are releasing the end product."><meta property="og:type" content="article"><meta property="og:url" content="http://smsohan.com/blog/2008/03/11/testing-internal-class-in-net-c/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2008-03-11T00:00:00+00:00"><meta property="article:modified_time" content="2008-03-11T00:00:00+00:00"><meta itemprop=name content="Testing Internal Class in .Net C#"><meta itemprop=description content="I have been to a situation where only a small number of classes had been declared as public classes in an assembly. And most of the classes are declared as internal, because I wanted to expose only the public classes to the consumers of my assembly.
However, doing so creates another challenge in testing the internal classes. As we most commonly want our test codes to reside on a separate assembly so that we can leave that assembly out when we are releasing the end product."><meta itemprop=datePublished content="2008-03-11T00:00:00+00:00"><meta itemprop=dateModified content="2008-03-11T00:00:00+00:00"><meta itemprop=wordCount content="293"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Testing Internal Class in .Net C#"><meta name=twitter:description content="I have been to a situation where only a small number of classes had been declared as public classes in an assembly. And most of the classes are declared as internal, because I wanted to expose only the public classes to the consumers of my assembly.
However, doing so creates another challenge in testing the internal classes. As we most commonly want our test codes to reside on a separate assembly so that we can leave that assembly out when we are releasing the end product."><style>.athelas,.body-text{font-family:helvetica neue,Helvetica,Arial,sans-serif}.body-text div,p,article,section{font-size:1rem;line-height:1.4rem}.athelas.fw1{font-weight:inherit}h1.f1{line-height:4rem}</style></head><body class="ma0 body-text"><header><div class=bg-navy><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Sohan's Blog</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/home/ title="About page">About</a></li></ul><div class=ananke-socials></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class="mt3 ananke-socials"></div><h1 class="f1 athelas mt3 mb1">Testing Internal Class in .Net C#</h1><time class="f6 mv4 dib tracked" datetime=2008-03-11T00:00:00Z>March 11, 2008</time></header><div class="nested-copy-line-height lh-copy body-text f4 nested-links mid-gray pr4-l w-two-thirds-l"><div class=post>I have been to a situation where only a small number of classes had been declared as <span style="color:#006;font-family:courier new">public</span> classes in an assembly. And most of the classes are declared as<span style="color:#009;font-family:courier new"> internal</span>, because I wanted to expose only the public classes to the consumers of my assembly.<br><br>However, doing so creates another challenge in testing the <span style="color:#009;font-family:courier new">internal</span> classes. As we most commonly want our test codes to reside on a separate assembly so that we can leave that assembly out when we are releasing the end product. And the internal access control would makes it difficult to write unit tests for these classes.<br><br>One workaround to this problem is to keep the test classes in the same assembly so that the test class has access to the internal class. However, to leave out these test classes from release configurations, we need to apply a <span style=font-weight:700>conditional compilation</span> for these files.<br><br>However, this is a pessimistic or short cut solution to the real problem. We actually want to test an internal class from another assembly (the test assembly) and don't want to go through reflection or other less intuitive paths.<br><br>I just found that, adding the following assembly attribute in the AssemblyInfo.cs may do the trick.<br><span style=font-weight:700><br><span style="color:red;font-family:courier new">[assembly: System.Runtime.CompilerServices.InternalsVisibleTo("TestAssemblyName")]</span></span><br><br>Adding this attribute will make the assembly's internals visible to the assembly thats specified in the argument.<br><br>So, once this attribute is added to an assembly, the test assembly treats the internal classes just as other public ones and need not worry about access protection problems.</div><h2>Comments</h2><div class=comments><div class=comment><div class=author>Sohan</div><div class=content>Its good to see such an old post still helps people!</div></div><div class=comment><div class=author>Anonymous</div><div class=content>Thanks a great deal!</div></div><div class=comment><div class=author>Sohan</div><div class=content>Thanks @romitch!</div></div><div class=comment><div class=author>romitch</div><div class=content>Very helpful. Thanks for the hint</div></div><div class=comment><div class=author>Anonymous</div><div class=content>excellent tip!</div></div><div class=comment><div class=author>Sohan</div><div class=content>You are welcome!</div></div><div class=comment><div class=author>Anonymous</div><div class=content>Thanks worked great in my projects!</div></div></div><ul class=pa0></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-navy bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=http://smsohan.com/>&copy; Sohan's Blog 2023</a><div><div class=ananke-socials></div></div></div></footer></body></html>